# 运行时数据区域

* 程序计数器
* Java虚拟机栈
    * 栈帧
* 本地方法栈
* 堆
    * 新生代: Surviver, Eden
    * 老年代
    * (永久代/方法区)
* 方法区


栈帧:
* 局部变量表
    * 基本类型
    * reference类型
    * returnAddress类型
* 操作数栈
* 动态链接 (类解析结果)
* 方法出口

方法区:
* 类相关
    * 类信息
    * 静态变量
    * 方法代码
    * **运行时常量池**:
        * 字面量 (String)
        * 符号引用 (类引用, 方法引用, 域引用等)解析时用到

堆:
* 对象实例在堆中分配内存:
* 参数:
    * -Xms200m: 初始堆内存大小
    * -Xmx200m: 最大堆内存大小
    
# 对象
对象结构:
* 对象头
* 实例数据
* 对齐填充

对象创建过程:
1. 先检查运行时常量池中有没对象的符号引用
2. 检查符号引用是否经过加载, 验证, 解析, 初始化
3. 分配空间, 并置0
4. 设置对象头

![](object_header.jpg)

对象访问定位:
* 句柄池: 在堆中分配句柄池, 每个句柄有两个指针, 一个指向对象实例数据, 一个指向对象类型数据
* 直接指针访问: 在堆中分配对象内存, 每个实例包括其实例数据和一个指向对象类型数据的指针