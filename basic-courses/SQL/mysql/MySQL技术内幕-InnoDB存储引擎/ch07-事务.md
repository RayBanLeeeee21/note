# Chapter 07 事务

## 7.1 认识事务

ACID:
- 原子性(Atomicity): 要么做, 要么不做, 不能停在中间状态
- 一致性(Consistency): 总是从一个一致状态转移到另一个一致状态. 完整性约束(如唯一性)不会被破坏
- 隔离性(Isolation): 事务不会看到其它事务的中间状态
    - 反例: 脏读
- 持久性(Durability): 只要提交了的事务, 其数据一定不会消失
    - 反例: 写缓冲后未fsync, 宕机后丢数据

### 7.1.2 分类

事务分类
- **扁平事务**
- **带保存点的扁平事务**
- **链事务**
- 嵌套事务
- **分布式事务**

带保存点的扁平事务: 
- 保存点: 
    - 事务回滚时不一定要回滚到最开始, 可以回滚到最近一个保存点及之前的保存点
    - 保存点是**易失**的, 在事务中间宕机, 保存点会丢失
        - 即是说保存点的设计初衷不是为了分阶段保存, 而是为了**定点回滚**

链事务: 多个事务相连, 一个事务结束时, 立即开始下一个事务
- T1结束-T2开始的过程是**原子**的
- 与保存点的区别在于, **只能回滚当前事务**


嵌套事务:
- 